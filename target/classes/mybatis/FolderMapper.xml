<?xml version="1.0" encoding="UTF-8" ?>
<!--MyBatis配置文件-->
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Config 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">


<mapper namespace="com.example.netdisk.dao.FolderDao">


    <!--AddFolder-->
    <insert id="AddFolder" parameterType="com.example.netdisk.DBEntity.FolderEntity">
        insert into folder(FolderName,ParentId,UserId)
        VALUE (#{FolderName},#{ParentId},#{UserId});
        <selectKey resultType="java.lang.Integer" keyProperty="id">
            SELECT @@IDENTITY AS ID
        </selectKey>
    </insert>


    <!--FolderRename-->
    <update id="FolderRename" parameterType="com.example.netdisk.DBEntity.FolderEntity">
        update folder
        set FolderName= #{FolderName}
        where Id = #{Id}
    </update>

    <!--DelFolder-->
    <update id="DelFolder" parameterType="com.example.netdisk.DBEntity.FolderEntity">
        delete
        folder where Id=
        #{Id}
    </update>

    <!--GetFolderByParentIdAndUserId-->
    <select id="GetFolderByParentIdAndUserId" parameterType="com.example.netdisk.pojo.query.FolderQuery"
            resultType="com.example.netdisk.DBEntity.FolderEntity">
        select *
        from folder
        <where>
            <if test="UserId!=-1">
                and UserId = #{UserId}
            </if>
            <if test="ParentId!=-1">
                and ParentId = #{ParentId}
            </if>
        </where>
    </select>

    <!--GetFolderByFolderId-->
    <select id="GetFolderByFolderId" parameterType="com.example.netdisk.pojo.query.FolderQuery"
            resultType="com.example.netdisk.DBEntity.FolderEntity">
        select *
        from folder
        <where>
            <if test="Id!=-1">
                and Id = #{Id}
            </if>
        </where>
    </select>

    <!--GetFolderByUserId-->
    <select id="GetFolderByUserId" parameterType="com.example.netdisk.pojo.query.FolderQuery"
            resultType="com.example.netdisk.DBEntity.FolderEntity">
        select *
        from folder
        <where>
            <if test="UserId">
                and UserId = #{UserId}
            </if>
        </where>
    </select>

    <!--GetFolderByParentId-->
    <select id="GetFolderByParentId" parameterType="com.example.netdisk.pojo.query.FolderQuery"
            resultType="com.example.netdisk.DBEntity.FolderEntity">
        select *
        from folder
        <where>
            <if test="ParentId">
                and ParentId = #{ParentId}
            </if>
        </where>
    </select>

    <!--GetFolders-->
    <select id="GetFolders" resultType="com.example.netdisk.DBEntity.FolderEntity">
        select *
        from folder;
    </select>
</mapper>